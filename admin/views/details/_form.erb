<div id="select-group">
  <% error = @detail.errors.include?(:name) %>
<fieldset class='control-group <%= error ? 'has-error' : ''%>'>
  <%= f.label :name, :class => 'control-label' %>
  <div class='controls'>
    <%= f.text_field :name, :class => 'form-control input-xlarge input-with-feedback' %>
    <span class='help-inline'><%= error ? f.error_message_on(:name) : "Ex: a simple text" %></span>
  </div>
</fieldset>
  <% error = @detail.errors.include?(:street_id) %>
<fieldset class='control-group <%= error ? 'has-error' : ''%>'>
  <%= f.label :street_id, :class => 'control-label' %>
  <div class='controls'>
    <%= f.text_field :street_id, :class => 'form-control input-xlarge input-with-feedback', :autofocus => true %>
    <span class='help-inline'><%= error ? f.error_message_on(:street_id) : "Ex: a simple text" %></span>
  </div>
</fieldset>
<% error = @detail.errors.include?(:city_id) %>
<fieldset class='control-group <%= error ? 'has-error' : ''%>'>
  <%= f.label :city_id, :class => 'control-label' %>
  <div class='controls'>
    <%= f.text_field :city_id, :class => 'form-control input-xlarge input-with-feedback' %>
    <span class='help-inline'><%= error ? f.error_message_on(:city_id) : "Ex: a simple text" %></span>
  </div>
</fieldset>
<% error = @detail.errors.include?(:area_id) %>
<fieldset class='control-group <%= error ? 'has-error' : ''%>'>
  <%= f.label :area_id, :class => 'control-label' %>
  <div class='controls'>
    <%= f.text_field :area_id, :class => 'form-control input-xlarge input-with-feedback' %>
    <span class='help-inline'><%= error ? f.error_message_on(:area_id) : "Ex: a simple text" %></span>
  </div>
</fieldset>
<% error = @detail.errors.include?(:province_id) %>
<fieldset class='control-group <%= error ? 'has-error' : ''%>'>
  <%= f.label :province_id, :class => 'control-label' %>
  <div class='controls'>
    <%= f.text_field :province_id, :class => 'form-control input-xlarge input-with-feedback' %>
    <span class='help-inline'><%= error ? f.error_message_on(:province_id) : "Ex: a simple text" %></span>
  </div>
</fieldset>
<% error = @detail.errors.include?(:country_id) %>
<fieldset class='control-group <%= error ? 'has-error' : ''%>'>
  <%= f.label :country_id, :class => 'control-label' %>
  <div class='controls'>
    <%= f.text_field :country_id, :class => 'form-control input-xlarge input-with-feedback' %>
    <span class='help-inline'><%= error ? f.error_message_on(:country_id) : "Ex: a simple text" %></span>
  </div>
</fieldset>
<% error = @detail.errors.include?(:planet_id) %>
<fieldset class='control-group <%= error ? 'has-error' : ''%>'>
  <%= f.label :所属星球, :class => 'control-label' %>
  <div class='controls'>
    <%= f.select(:planet_id, :collection => Planet.all, :fields => [:name, :id], :class => 'form-control input-xlarge input-with-feedback', :autofocus => true, :include_blank => true) %>
  </div>
</fieldset> 
</div>

<div class="form-actions">
  <%= f.submit pat(:save), :class => 'btn btn-primary' %>
  &nbsp;
  <%= f.submit pat(:save_and_continue), :class => 'btn btn-info', :name => 'save_and_continue' %>
  &nbsp;
  <%= link_to pat(:cancel), url(:details, :index), :class => 'btn btn-default' %>
</div>
<%= javascript_include_tag 'jquery-1.11.0.min', :application %>
<script type="text/javascript">
          function select_province(val){
                $('#detail_province_new').remove();
                $.get( "get_province_select?country_id="+val, function( data ) {
                  var head= '<fieldset class="control-group" id="detail_province_new"><label for="province" value="" class="control-label">所属省份: </label><div class="controls"><select name="detail[country_id]" id="detail_province_id" class="form-control input-xlarge input-with-feedback" autofocus="autofocus" >';
                 var body = '<option></option>';
                 var obj =JSON.parse(data)
                 if (obj != null) {
                 for(var i=0; i<obj.length ; i++){
                    body+= '<option value="'+obj[i]._id+'">'+obj[i].name+'</option>'
                  } 
                  var end = '</select></div></fieldset>';
                 $('#select-group').append(head+body+end);
               }else{

               }
                  });
      }
$(document).ready(function(){
  $("#detail_planet_id").change(function(){
    $('#detail_country_new').remove();
   $.get( "get_country_select?planet_id="+$(this).val(), function( data ) {
      var head = '<fieldset class="control-group" id="detail_country_new"><label for="province_所属国家" value="" class="control-label">所属国家: </label><div class="controls"><select name="detail[country_id]" id="detail_country_id" class="form-control input-xlarge input-with-feedback" autofocus="autofocus" onchange="select_province(this.value);">';
       var body = '<option></option>';
       var obj =JSON.parse(data)
      for(var i=0; i<obj.length ; i++){
          body+= '<option value="'+obj[i]._id+'">'+obj[i].name+'</option>'
      }
       var end = '</select></div></fieldset>';
     $('#select-group').append(head+body+end);
     

             

      });
  });


                
});
  
</script>